{% extends "base.html" %}

{% block content %}
<h1>Upcoming Events</h1>

{% if not events %}
  <p class="empty">No upcoming events found. Run <code>cv scrape</code> to fetch events.</p>
{% else %}
  <table class="events-table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Event</th>
        <th>Venue</th>
        <th>Price</th>
      </tr>
    </thead>
    <tbody>
      {% for event in events %}
      <tr{% if event.sold_out %} class="sold-out"{% endif %}>
        <td class="date">{{ event.date.strftime("%a, %b %-d") }}</td>
        <td class="title">
          <a href="{{ event.url }}" target="_blank" rel="noopener">{{ event.title }}</a>
          {% if event.sold_out %}<span class="badge sold-out-badge">Sold out</span>{% endif %}
          {% if event.time %}<span class="time">{{ event.time.strftime("%-I:%M %p") }}</span>{% endif %}
        </td>
        <td class="venue">
          {% set venue = venues.get(event.venue_key) %}
          {% if venue %}
            <a href="{{ venue.url }}" target="_blank" rel="noopener">{{ venue.name }}</a>
          {% else %}
            {{ event.venue_key }}
          {% endif %}
        </td>
        <td class="price">{{ event.price or "â€”" }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endif %}
{% endblock %}
